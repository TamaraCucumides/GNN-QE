/mnt/ialabnas/homes/tacucumides
scylla
Thu Aug 24 22:03:37 -04 2023
Start training
/mnt/ialabnas/homes/tacucumides
22:03:44   Config file: config/fb15k237.yaml
22:03:44   {'dataset': {'class': 'FB15k237LogicalQuery', 'path': '~/kg-datasets/'},
 'engine': {'batch_size': 48, 'gpus': [0]},
 'metric': 'mrr',
 'optimizer': {'class': 'Adam', 'lr': 0.005},
 'output_dir': '~/scratch/experiments/',
 'task': {'adversarial_temperature': 0.2,
          'class': 'LogicalQuery',
          'criterion': 'bce',
          'model': {'class': 'GNN-QE',
                    'dropout_ratio': 0.25,
                    'logic': 'product',
                    'model': {'aggregate_func': 'pna',
                              'class': 'NBFNet',
                              'dependent': True,
                              'hidden_dims': [32, 32, 32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True}},
          'sample_weight': False},
 'train': {'batch_per_epoch': 1000, 'num_epoch': 10}}
22:03:44   Downloading http://snap.stanford.edu/betae/KG_data.zip to /home/tacucumides/kg-datasets/KG_data.zip
22:34:41   Extracting /home/tacucumides/kg-datasets/KG_data.zip to /home/tacucumides/kg-datasets
Loading /home/tacucumides/kg-datasets/FB15k-237-betae/train.txt:   0%|          | 0/544230 [00:00<?, ?it/s]Loading /home/tacucumides/kg-datasets/FB15k-237-betae/train.txt:  16%|█▌        | 85654/544230 [00:00<00:00, 856461.18it/s]Loading /home/tacucumides/kg-datasets/FB15k-237-betae/train.txt:  32%|███▏      | 176165/544230 [00:00<00:00, 885058.93it/s]Loading /home/tacucumides/kg-datasets/FB15k-237-betae/train.txt:  49%|████▉     | 267236/544230 [00:00<00:00, 896761.03it/s]Loading /home/tacucumides/kg-datasets/FB15k-237-betae/train.txt:  66%|██████▌   | 358230/544230 [00:00<00:00, 901953.95it/s]Loading /home/tacucumides/kg-datasets/FB15k-237-betae/train.txt:  83%|████████▎ | 449383/544230 [00:00<00:00, 905394.14it/s]Loading /home/tacucumides/kg-datasets/FB15k-237-betae/train.txt:  99%|█████████▉| 540291/544230 [00:00<00:00, 906638.78it/s]Loading /home/tacucumides/kg-datasets/FB15k-237-betae/train.txt: 100%|██████████| 544230/544230 [00:00<00:00, 900289.16it/s]
Loading /home/tacucumides/kg-datasets/FB15k-237-betae/valid.txt:   0%|          | 0/35052 [00:00<?, ?it/s]Loading /home/tacucumides/kg-datasets/FB15k-237-betae/valid.txt: 100%|██████████| 35052/35052 [00:00<00:00, 848289.47it/s]
Loading /home/tacucumides/kg-datasets/FB15k-237-betae/test.txt:   0%|          | 0/40876 [00:00<?, ?it/s]Loading /home/tacucumides/kg-datasets/FB15k-237-betae/test.txt: 100%|██████████| 40876/40876 [00:00<00:00, 846866.21it/s]
Loading train-*.pkl:   0%|          | 0/3 [00:00<?, ?it/s]Loading train-*.pkl:  33%|███▎      | 1/3 [00:00<00:01,  1.48it/s]Loading train-*.pkl: 100%|██████████| 3/3 [00:24<00:00,  8.90s/it]
Processing train queries:   0%|          | 0/823285 [00:00<?, ?it/s][ALoading train-*.pkl: 100%|██████████| 3/3 [00:24<00:00,  8.07s/it]

Processing train queries:   0%|          | 1/823285 [00:00<33:07:32,  6.90it/s][A
Processing train queries:   0%|          | 3875/823285 [00:00<00:42, 19238.57it/s][A
Processing train queries:   1%|          | 8311/823285 [00:00<00:27, 29662.81it/s][A
Processing train queries:   2%|▏         | 12745/823285 [00:00<00:23, 35123.90it/s][A
Processing train queries:   2%|▏         | 17200/823285 [00:00<00:20, 38395.71it/s][A
Processing train queries:   3%|▎         | 21753/823285 [00:00<00:19, 40759.35it/s][A
Processing train queries:   3%|▎         | 26238/823285 [00:00<00:18, 42072.93it/s][A
Processing train queries:   4%|▎         | 30805/823285 [00:00<00:18, 43183.21it/s][A
Processing train queries:   4%|▍         | 35400/823285 [00:00<00:17, 44040.06it/s][A
Processing train queries:   5%|▍         | 39898/823285 [00:01<00:17, 44324.47it/s][A
Processing train queries:   5%|▌         | 44356/823285 [00:01<00:17, 44340.79it/s][A
Processing train queries:   6%|▌         | 48865/823285 [00:01<00:17, 44566.08it/s][A
Processing train queries:   6%|▋         | 53337/823285 [00:01<00:17, 44609.38it/s][A
Processing train queries:   7%|▋         | 57807/823285 [00:01<00:17, 43996.74it/s][A
Processing train queries:   8%|▊         | 62215/823285 [00:01<00:17, 43953.98it/s][A
Processing train queries:   8%|▊         | 66616/823285 [00:01<00:17, 43865.45it/s][A
Processing train queries:   9%|▊         | 71209/823285 [00:01<00:16, 44479.36it/s][A
Processing train queries:   9%|▉         | 75755/823285 [00:01<00:16, 44770.69it/s][A
Processing train queries:  10%|▉         | 80319/823285 [00:01<00:16, 45028.92it/s][A
Processing train queries:  10%|█         | 84970/823285 [00:02<00:16, 45471.45it/s][A
Processing train queries:  11%|█         | 89519/823285 [00:02<00:16, 45013.32it/s][A
Processing train queries:  11%|█▏        | 94125/823285 [00:02<00:16, 45322.85it/s][A
Processing train queries:  12%|█▏        | 98731/823285 [00:02<00:15, 45542.54it/s][A
Processing train queries:  13%|█▎        | 103287/823285 [00:02<00:15, 45509.16it/s][A
Processing train queries:  13%|█▎        | 107870/823285 [00:02<00:15, 45602.46it/s][A
Processing train queries:  14%|█▎        | 112525/823285 [00:02<00:15, 45884.77it/s][A
Processing train queries:  14%|█▍        | 117114/823285 [00:02<00:15, 45884.02it/s][A
Processing train queries:  15%|█▍        | 121742/823285 [00:02<00:15, 46001.27it/s][A
Processing train queries:  15%|█▌        | 126359/823285 [00:02<00:15, 46050.08it/s][A
Processing train queries:  16%|█▌        | 130965/823285 [00:03<00:15, 46025.56it/s][A
Processing train queries:  16%|█▋        | 135568/823285 [00:03<00:14, 45895.78it/s][A
Processing train queries:  17%|█▋        | 140221/823285 [00:03<00:14, 46083.23it/s][A
Processing train queries:  18%|█▊        | 144830/823285 [00:03<00:14, 45980.85it/s][A
Processing train queries:  18%|█▊        | 149461/823285 [00:03<00:14, 46076.66it/s][A
Processing train queries:  19%|█▊        | 154069/823285 [00:03<00:21, 31023.04it/s][A
Processing train queries:  19%|█▉        | 158523/823285 [00:03<00:19, 34043.50it/s][A
Processing train queries:  20%|█▉        | 162953/823285 [00:03<00:18, 36525.90it/s][A
Processing train queries:  20%|██        | 167438/823285 [00:04<00:16, 38664.69it/s][A
Processing train queries:  21%|██        | 171994/823285 [00:04<00:16, 40515.17it/s][A
Processing train queries:  21%|██▏       | 176313/823285 [00:04<00:15, 40790.20it/s][A
Processing train queries:  22%|██▏       | 180810/823285 [00:04<00:15, 41964.27it/s][A
Processing train queries:  23%|██▎       | 185362/823285 [00:04<00:14, 42983.55it/s][A
Processing train queries:  23%|██▎       | 189836/823285 [00:04<00:14, 43491.80it/s][A
Processing train queries:  24%|██▎       | 194358/823285 [00:04<00:14, 43997.24it/s][A
Processing train queries:  24%|██▍       | 198901/823285 [00:04<00:14, 44418.83it/s][A
Processing train queries:  25%|██▍       | 203381/823285 [00:04<00:13, 44515.30it/s][A
Processing train queries:  25%|██▌       | 207914/823285 [00:04<00:13, 44755.29it/s][A
Processing train queries:  26%|██▌       | 212440/823285 [00:05<00:13, 44904.96it/s][A
Processing train queries:  26%|██▋       | 216946/823285 [00:05<00:13, 44950.27it/s][A
Processing train queries:  27%|██▋       | 221489/823285 [00:05<00:13, 45091.10it/s][A
Processing train queries:  27%|██▋       | 226041/823285 [00:05<00:13, 45217.75it/s][A
Processing train queries:  28%|██▊       | 230568/823285 [00:05<00:13, 44807.17it/s][A
Processing train queries:  29%|██▊       | 235122/823285 [00:05<00:13, 45022.77it/s][A
Processing train queries:  29%|██▉       | 239629/823285 [00:05<00:12, 45034.73it/s][A
Processing train queries:  30%|██▉       | 244206/823285 [00:05<00:12, 45253.16it/s][A
Processing train queries:  30%|███       | 248733/823285 [00:05<00:12, 45145.21it/s][A
Processing train queries:  31%|███       | 253275/823285 [00:05<00:12, 45226.20it/s][A
Processing train queries:  31%|███▏      | 257799/823285 [00:06<00:12, 45035.19it/s][A
Processing train queries:  32%|███▏      | 262316/823285 [00:06<00:12, 45072.98it/s][A
Processing train queries:  32%|███▏      | 266861/823285 [00:06<00:12, 45183.52it/s][A
Processing train queries:  33%|███▎      | 271380/823285 [00:06<00:12, 45108.77it/s][A
Processing train queries:  34%|███▎      | 275892/823285 [00:06<00:12, 44998.63it/s][A
Processing train queries:  34%|███▍      | 280393/823285 [00:06<00:12, 44946.80it/s][A
Processing train queries:  35%|███▍      | 284982/823285 [00:06<00:11, 45225.84it/s][A
Processing train queries:  35%|███▌      | 289505/823285 [00:06<00:11, 45131.95it/s][A
Processing train queries:  36%|███▌      | 294073/823285 [00:06<00:11, 45293.43it/s][A
Processing train queries:  36%|███▋      | 298603/823285 [00:06<00:11, 45243.17it/s][A
Processing train queries:  37%|███▋      | 303128/823285 [00:07<00:17, 30502.73it/s][A
Processing train queries:  37%|███▋      | 307218/823285 [00:07<00:15, 32828.45it/s][A
Processing train queries:  38%|███▊      | 311650/823285 [00:07<00:14, 35610.33it/s][A
Processing train queries:  38%|███▊      | 316120/823285 [00:07<00:13, 37946.02it/s][A
Processing train queries:  39%|███▉      | 320534/823285 [00:07<00:12, 39608.35it/s][A
Processing train queries:  39%|███▉      | 324955/823285 [00:07<00:12, 40882.90it/s][A
Processing train queries:  40%|████      | 329362/823285 [00:07<00:11, 41787.09it/s][A
Processing train queries:  41%|████      | 333704/823285 [00:07<00:11, 42255.42it/s][A
Processing train queries:  41%|████      | 338049/823285 [00:07<00:11, 42601.86it/s][A
Processing train queries:  42%|████▏     | 342450/823285 [00:08<00:11, 43014.69it/s][A
Processing train queries:  42%|████▏     | 346827/823285 [00:08<00:11, 43236.10it/s][A
Processing train queries:  43%|████▎     | 351187/823285 [00:08<00:11, 41260.11it/s][A
Processing train queries:  43%|████▎     | 355606/823285 [00:08<00:11, 42102.04it/s][A
Processing train queries:  44%|████▎     | 360058/823285 [00:08<00:10, 42804.56it/s][A
Processing train queries:  44%|████▍     | 364520/823285 [00:08<00:10, 43335.64it/s][A
Processing train queries:  45%|████▍     | 368902/823285 [00:08<00:10, 43476.72it/s][A
Processing train queries:  45%|████▌     | 373376/823285 [00:08<00:10, 43851.11it/s][A
Processing train queries:  46%|████▌     | 377839/823285 [00:08<00:10, 44081.89it/s][A
Processing train queries:  46%|████▋     | 382311/823285 [00:09<00:09, 44271.24it/s][A
Processing train queries:  47%|████▋     | 386744/823285 [00:09<00:09, 44238.94it/s][A
Processing train queries:  48%|████▊     | 391172/823285 [00:11<01:20, 5392.36it/s] [A
Processing train queries:  48%|████▊     | 395503/823285 [00:11<00:58, 7268.41it/s][A
Processing train queries:  49%|████▊     | 399843/823285 [00:11<00:43, 9653.61it/s][A
Processing train queries:  49%|████▉     | 404204/823285 [00:11<00:33, 12579.97it/s][A
Processing train queries:  50%|████▉     | 408588/823285 [00:12<00:25, 16006.35it/s][A
Processing train queries:  50%|█████     | 412791/823285 [00:12<00:21, 19529.72it/s][A
Processing train queries:  51%|█████     | 417268/823285 [00:12<00:17, 23620.40it/s][A
Processing train queries:  51%|█████     | 421716/823285 [00:12<00:14, 27541.20it/s][A
Processing train queries:  52%|█████▏    | 426149/823285 [00:12<00:12, 31095.14it/s][A
Processing train queries:  52%|█████▏    | 430588/823285 [00:12<00:11, 34180.64it/s][A
Processing train queries:  53%|█████▎    | 435036/823285 [00:12<00:10, 36745.24it/s][A
Processing train queries:  53%|█████▎    | 439425/823285 [00:12<00:10, 38380.61it/s][A
Processing train queries:  54%|█████▍    | 443784/823285 [00:12<00:09, 39366.16it/s][A
Processing train queries:  54%|█████▍    | 448093/823285 [00:12<00:09, 40112.49it/s][A
Processing train queries:  55%|█████▍    | 452369/823285 [00:13<00:19, 19180.25it/s][A
Processing train queries:  55%|█████▌    | 455875/823285 [00:13<00:16, 21707.26it/s][A
Processing train queries:  56%|█████▌    | 459750/823285 [00:13<00:14, 24863.92it/s][A
Processing train queries:  56%|█████▋    | 463298/823285 [00:13<00:13, 27085.19it/s][A
Processing train queries:  57%|█████▋    | 467219/823285 [00:13<00:11, 29875.36it/s][A
Processing train queries:  57%|█████▋    | 471106/823285 [00:13<00:10, 32099.09it/s][A
Processing train queries:  58%|█████▊    | 474994/823285 [00:14<00:10, 33869.40it/s][A
Processing train queries:  58%|█████▊    | 478885/823285 [00:14<00:09, 35236.49it/s][A
Processing train queries:  59%|█████▊    | 482804/823285 [00:14<00:09, 36340.63it/s][A
Processing train queries:  59%|█████▉    | 486640/823285 [00:14<00:09, 36877.00it/s][A
Processing train queries:  60%|█████▉    | 490474/823285 [00:14<00:08, 37297.95it/s][A
Processing train queries:  60%|██████    | 494307/823285 [00:14<00:08, 37493.37it/s][A
Processing train queries:  61%|██████    | 498139/823285 [00:14<00:08, 37734.34it/s][A
Processing train queries:  61%|██████    | 501964/823285 [00:14<00:08, 37671.28it/s][A
Processing train queries:  61%|██████▏   | 505767/823285 [00:14<00:08, 37412.76it/s][A
Processing train queries:  62%|██████▏   | 509534/823285 [00:14<00:08, 37434.45it/s][A
Processing train queries:  62%|██████▏   | 513305/823285 [00:15<00:08, 37514.71it/s][A
Processing train queries:  63%|██████▎   | 517095/823285 [00:15<00:08, 37627.82it/s][A
Processing train queries:  63%|██████▎   | 520913/823285 [00:15<00:08, 36981.64it/s][A
Processing train queries:  64%|██████▎   | 524808/823285 [00:15<00:07, 37558.33it/s][A
Processing train queries:  64%|██████▍   | 528687/823285 [00:15<00:07, 37920.79it/s][A
Processing train queries:  65%|██████▍   | 532612/823285 [00:15<00:07, 38314.75it/s][A
Processing train queries:  65%|██████▌   | 536448/823285 [00:15<00:07, 38278.67it/s][A
Processing train queries:  66%|██████▌   | 540279/823285 [00:15<00:07, 38170.94it/s][A
Processing train queries:  66%|██████▌   | 544099/823285 [00:15<00:07, 38177.42it/s][A
Processing train queries:  67%|██████▋   | 547919/823285 [00:15<00:07, 37970.93it/s][A
Processing train queries:  67%|██████▋   | 551718/823285 [00:16<00:07, 37933.83it/s][A
Processing train queries:  67%|██████▋   | 555517/823285 [00:16<00:07, 37949.03it/s][A
Processing train queries:  68%|██████▊   | 559313/823285 [00:16<00:07, 37663.19it/s][A
Processing train queries:  68%|██████▊   | 563081/823285 [00:16<00:06, 37492.73it/s][A
Processing train queries:  69%|██████▉   | 566831/823285 [00:16<00:06, 37433.71it/s][A
Processing train queries:  69%|██████▉   | 570575/823285 [00:16<00:06, 37399.57it/s][A
Processing train queries:  70%|██████▉   | 574316/823285 [00:16<00:06, 37371.89it/s][A
Processing train queries:  70%|███████   | 578054/823285 [00:16<00:06, 37365.73it/s][A
Processing train queries:  71%|███████   | 581812/823285 [00:16<00:06, 37428.09it/s][A
Processing train queries:  71%|███████   | 585597/823285 [00:16<00:06, 37553.03it/s][A
Processing train queries:  72%|███████▏  | 589353/823285 [00:17<00:06, 36692.99it/s][A
Processing train queries:  72%|███████▏  | 593255/823285 [00:17<00:06, 37377.54it/s][A
Processing train queries:  73%|███████▎  | 597159/823285 [00:17<00:05, 37870.04it/s][A
Processing train queries:  73%|███████▎  | 600950/823285 [00:17<00:13, 17031.56it/s][A
Processing train queries:  73%|███████▎  | 604356/823285 [00:17<00:11, 19762.00it/s][A
Processing train queries:  74%|███████▍  | 608055/823285 [00:17<00:09, 22972.46it/s][A
Processing train queries:  74%|███████▍  | 611765/823285 [00:18<00:08, 25942.70it/s][A
Processing train queries:  75%|███████▍  | 615313/823285 [00:18<00:07, 28145.79it/s][A
Processing train queries:  75%|███████▌  | 618872/823285 [00:18<00:06, 29992.60it/s][A
Processing train queries:  76%|███████▌  | 622451/823285 [00:18<00:06, 31508.57it/s][A
Processing train queries:  76%|███████▌  | 626053/823285 [00:18<00:06, 32733.76it/s][A
Processing train queries:  76%|███████▋  | 629633/823285 [00:18<00:05, 33591.82it/s][A
Processing train queries:  77%|███████▋  | 633222/823285 [00:18<00:05, 34248.27it/s][A
Processing train queries:  77%|███████▋  | 636806/823285 [00:18<00:05, 34709.50it/s][A
Processing train queries:  78%|███████▊  | 640407/823285 [00:18<00:05, 35089.45it/s][A
Processing train queries:  78%|███████▊  | 644023/823285 [00:18<00:05, 35404.08it/s][A
Processing train queries:  79%|███████▊  | 647612/823285 [00:19<00:04, 35300.10it/s][A
Processing train queries:  79%|███████▉  | 651176/823285 [00:19<00:05, 31468.14it/s][A
Processing train queries:  80%|███████▉  | 654793/823285 [00:19<00:05, 32751.71it/s][A
Processing train queries:  80%|███████▉  | 658400/823285 [00:19<00:04, 33680.84it/s][A
Processing train queries:  80%|████████  | 661832/823285 [00:19<00:04, 33301.99it/s][A
Processing train queries:  81%|████████  | 665581/823285 [00:19<00:04, 34500.39it/s][A
Processing train queries:  81%|████████▏ | 669333/823285 [00:19<00:04, 35375.51it/s][A
Processing train queries:  82%|████████▏ | 673103/823285 [00:19<00:04, 36056.51it/s][A
Processing train queries:  82%|████████▏ | 676857/823285 [00:19<00:04, 36493.14it/s][A
Processing train queries:  83%|████████▎ | 680647/823285 [00:20<00:03, 36908.94it/s][A
Processing train queries:  83%|████████▎ | 684439/823285 [00:20<00:03, 37209.07it/s][A
Processing train queries:  84%|████████▎ | 688169/823285 [00:20<00:03, 37230.91it/s][A
Processing train queries:  84%|████████▍ | 691898/823285 [00:20<00:03, 36979.01it/s][A
Processing train queries:  84%|████████▍ | 695601/823285 [00:20<00:03, 36904.47it/s][A
Processing train queries:  85%|████████▍ | 699295/823285 [00:20<00:03, 32682.42it/s][A
Processing train queries:  85%|████████▌ | 702700/823285 [00:23<00:31, 3871.92it/s] [A
Processing train queries:  86%|████████▌ | 706394/823285 [00:23<00:21, 5319.64it/s][A
Processing train queries:  86%|████████▋ | 710155/823285 [00:23<00:15, 7220.24it/s][A
Processing train queries:  87%|████████▋ | 713943/823285 [00:23<00:11, 9598.34it/s][A
Processing train queries:  87%|████████▋ | 717727/823285 [00:23<00:08, 12415.44it/s][A
Processing train queries:  88%|████████▊ | 721512/823285 [00:23<00:06, 15587.88it/s][A
Processing train queries:  88%|████████▊ | 725309/823285 [00:24<00:05, 18972.83it/s][A
Processing train queries:  89%|████████▊ | 729079/823285 [00:24<00:04, 22299.22it/s][A
Processing train queries:  89%|████████▉ | 732858/823285 [00:24<00:03, 25433.77it/s][A
Processing train queries:  89%|████████▉ | 736643/823285 [00:24<00:03, 28217.27it/s][A
Processing train queries:  90%|████████▉ | 740367/823285 [00:24<00:02, 30232.85it/s][A
Processing train queries:  90%|█████████ | 744065/823285 [00:24<00:02, 30771.16it/s][A
Processing train queries:  91%|█████████ | 747840/823285 [00:24<00:02, 32589.50it/s][A
Processing train queries:  91%|█████████▏| 751460/823285 [00:24<00:02, 32472.08it/s][A
Processing train queries:  92%|█████████▏| 755405/823285 [00:24<00:01, 34373.38it/s][A
Processing train queries:  92%|█████████▏| 759357/823285 [00:24<00:01, 35816.09it/s][A
Processing train queries:  93%|█████████▎| 763272/823285 [00:25<00:01, 36767.19it/s][A
Processing train queries:  93%|█████████▎| 767057/823285 [00:25<00:01, 35225.96it/s][A
Processing train queries:  94%|█████████▎| 770833/823285 [00:25<00:01, 35939.18it/s][A
Processing train queries:  94%|█████████▍| 774603/823285 [00:25<00:01, 36444.59it/s][A
Processing train queries:  95%|█████████▍| 778296/823285 [00:25<00:01, 36539.85it/s][A
Processing train queries:  95%|█████████▍| 781984/823285 [00:25<00:01, 33740.66it/s][A
Processing train queries:  95%|█████████▌| 785614/823285 [00:25<00:01, 34451.97it/s][A
Processing train queries:  96%|█████████▌| 789231/823285 [00:25<00:00, 34939.87it/s][A
Processing train queries:  96%|█████████▋| 792815/823285 [00:25<00:00, 35197.58it/s][A
Processing train queries:  97%|█████████▋| 796362/823285 [00:26<00:00, 33991.40it/s][A
Processing train queries:  97%|█████████▋| 800128/823285 [00:26<00:00, 35043.82it/s][A
Processing train queries:  98%|█████████▊| 803910/823285 [00:26<00:00, 35850.52it/s][A
Processing train queries:  98%|█████████▊| 807636/823285 [00:26<00:00, 36263.21it/s][A
Processing train queries:  99%|█████████▊| 811277/823285 [00:26<00:00, 34794.11it/s][A
Processing train queries:  99%|█████████▉| 815016/823285 [00:26<00:00, 35540.64it/s][A
Processing train queries:  99%|█████████▉| 818741/823285 [00:26<00:00, 36037.68it/s][A
Processing train queries: 100%|█████████▉| 822461/823285 [00:26<00:00, 36355.41it/s][ALoading valid-*.pkl:   0%|          | 0/3 [00:00<?, ?it/s]Processing train queries: 100%|██████████| 823285/823285 [00:26<00:00, 30771.28it/s]
Loading valid-*.pkl:  67%|██████▋   | 2/3 [00:03<00:01,  1.55s/it]Loading valid-*.pkl: 100%|██████████| 3/3 [00:03<00:00,  1.20s/it]
Processing valid queries:   0%|          | 0/85094 [00:00<?, ?it/s][ALoading valid-*.pkl: 100%|██████████| 3/3 [00:03<00:00,  1.27s/it]

Processing valid queries:   4%|▍         | 3601/85094 [00:00<00:02, 36006.69it/s][A
Processing valid queries:  10%|▉         | 8212/85094 [00:00<00:01, 41948.02it/s][A
Processing valid queries:  15%|█▍        | 12407/85094 [00:00<00:01, 40873.43it/s][A
Processing valid queries:  20%|█▉        | 16953/85094 [00:00<00:01, 42653.85it/s][A
Processing valid queries:  25%|██▌       | 21359/85094 [00:00<00:01, 43155.36it/s][A
Processing valid queries:  30%|███       | 25882/85094 [00:00<00:01, 43854.54it/s][A
Processing valid queries:  36%|███▌      | 30271/85094 [00:03<00:11, 4648.16it/s] [A
Processing valid queries:  40%|████      | 34313/85094 [00:03<00:08, 6327.62it/s][A
Processing valid queries:  45%|████▍     | 37942/85094 [00:03<00:05, 8210.86it/s][A
Processing valid queries:  49%|████▊     | 41394/85094 [00:03<00:04, 10378.54it/s][A
Processing valid queries:  53%|█████▎    | 45095/85094 [00:03<00:03, 13135.03it/s][A
Processing valid queries:  58%|█████▊    | 49070/85094 [00:03<00:02, 16604.25it/s][A
Processing valid queries:  62%|██████▏   | 52754/85094 [00:03<00:01, 19780.79it/s][A
Processing valid queries:  66%|██████▋   | 56400/85094 [00:04<00:01, 22804.54it/s][A
Processing valid queries:  71%|███████   | 60095/85094 [00:04<00:00, 25323.37it/s][A
Processing valid queries:  75%|███████▌  | 63884/85094 [00:04<00:00, 28156.32it/s][A
Processing valid queries:  79%|███████▉  | 67523/85094 [00:04<00:00, 30080.24it/s][A
Processing valid queries:  84%|████████▎ | 71216/85094 [00:04<00:00, 31845.32it/s][A
Processing valid queries:  88%|████████▊ | 75095/85094 [00:04<00:00, 33161.09it/s][A
Processing valid queries:  93%|█████████▎| 79056/85094 [00:04<00:00, 34928.75it/s][A
Processing valid queries:  97%|█████████▋| 82798/85094 [00:04<00:00, 34751.64it/s][ALoading test-*.pkl:   0%|          | 0/3 [00:00<?, ?it/s]Processing valid queries: 100%|██████████| 85094/85094 [00:04<00:00, 17765.99it/s]
Loading test-*.pkl:  67%|██████▋   | 2/3 [00:02<00:01,  1.32s/it]Loading test-*.pkl: 100%|██████████| 3/3 [00:03<00:00,  1.05it/s]
Processing test queries:   0%|          | 0/87804 [00:00<?, ?it/s][ALoading test-*.pkl: 100%|██████████| 3/3 [00:03<00:00,  1.03s/it]

Processing test queries:   4%|▍         | 3403/87804 [00:00<00:02, 34026.54it/s][A
Processing test queries:   9%|▉         | 7896/87804 [00:00<00:01, 40437.94it/s][A
Processing test queries:  14%|█▍        | 12489/87804 [00:00<00:01, 42943.89it/s][A
Processing test queries:  19%|█▉        | 17062/87804 [00:00<00:01, 44041.86it/s][A
Processing test queries:  25%|██▍       | 21682/87804 [00:00<00:01, 44818.84it/s][A
Processing test queries:  30%|██▉       | 26164/87804 [00:00<00:01, 44499.45it/s][A
Processing test queries:  35%|███▍      | 30615/87804 [00:00<00:01, 42217.51it/s][A
Processing test queries:  40%|███▉      | 34859/87804 [00:00<00:01, 41330.56it/s][A
Processing test queries:  44%|████▍     | 39008/87804 [00:00<00:01, 39431.44it/s][A
Processing test queries:  49%|████▉     | 42973/87804 [00:01<00:01, 37949.39it/s][A
Processing test queries:  53%|█████▎    | 46788/87804 [00:01<00:01, 37799.08it/s][A
Processing test queries:  58%|█████▊    | 50581/87804 [00:01<00:00, 37337.84it/s][A
Processing test queries:  62%|██████▏   | 54336/87804 [00:01<00:00, 37397.82it/s][A
Processing test queries:  66%|██████▌   | 58082/87804 [00:01<00:00, 37345.72it/s][A
Processing test queries:  70%|███████   | 61891/87804 [00:01<00:00, 37564.01it/s][A
Processing test queries:  75%|███████▍  | 65651/87804 [00:01<00:00, 36683.07it/s][A
Processing test queries:  79%|███████▉  | 69325/87804 [00:01<00:00, 36421.96it/s][A
Processing test queries:  83%|████████▎ | 72971/87804 [00:01<00:00, 36261.97it/s][A
Processing test queries:  88%|████████▊ | 76834/87804 [00:01<00:00, 36956.64it/s][A
Processing test queries:  92%|█████████▏| 80539/87804 [00:02<00:00, 36984.23it/s][A
Processing test queries:  96%|█████████▌| 84240/87804 [00:02<00:00, 36505.17it/s][AProcessing test queries: 100%|██████████| 87804/87804 [00:02<00:00, 37933.34it/s]
22:36:25   FB15k237LogicalQuery(
  #entity: 14505
  #relation: 474
  #triplet: 620158
  #query: 996183
)
22:36:25   #train: 823285, #valid: 85094, #test: 87804
22:36:25   Preprocess training set
22:36:34   {'batch_size': 48,
 'class': 'core.Engine',
 'gpus': [0],
 'gradient_interval': 1,
 'log_interval': 100,
 'logger': 'logging',
 'num_worker': 0,
 'optimizer': {'amsgrad': False,
               'betas': (0.9, 0.999),
               'capturable': False,
               'class': 'optim.Adam',
               'differentiable': False,
               'eps': 1e-08,
               'foreach': None,
               'fused': False,
               'lr': 0.005,
               'maximize': False,
               'weight_decay': 0},
 'scheduler': None,
 'task': {'adversarial_temperature': 0.2,
          'class': 'task.LogicalQuery',
          'criterion': 'bce',
          'metric': ('mrr',),
          'model': {'class': 'model.GNN-QE',
                    'dropout_ratio': 0.25,
                    'logic': 'product',
                    'model': {'activation': 'relu',
                              'aggregate_func': 'pna',
                              'class': 'model.NBFNet',
                              'concat_hidden': False,
                              'dependent': True,
                              'hidden_dims': [32, 32, 32, 32],
                              'input_dim': 32,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'num_relation': tensor(474),
                              'short_cut': True},
                    'num_mlp_layer': 2},
          'sample_weight': False},
 'test_set': {'class': 'dataset.Subset',
              'dataset': {'class': 'dataset.FB15k237LogicalQuery',
                          'path': '~/kg-datasets/',
                          'query_types': None,
                          'union_type': 'DNF',
                          'verbose': 1},
              'indices': range(908379, 996183)},
 'train_set': {'class': 'dataset.Subset',
               'dataset': {'class': 'dataset.FB15k237LogicalQuery',
                           'path': '~/kg-datasets/',
                           'query_types': None,
                           'union_type': 'DNF',
                           'verbose': 1},
               'indices': range(0, 823285)},
 'valid_set': {'class': 'dataset.Subset',
               'dataset': {'class': 'dataset.FB15k237LogicalQuery',
                           'path': '~/kg-datasets/',
                           'query_types': None,
                           'union_type': 'DNF',
                           'verbose': 1},
               'indices': range(823285, 908379)}}
22:36:34   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
22:36:34   Epoch 0 begin
Traceback (most recent call last):
  File "/home/tacucumides/miniconda3/envs/gnn-qe/lib/python3.10/site-packages/torch/utils/cpp_extension.py", line 1900, in _run_ninja_build
    subprocess.run(
  File "/home/tacucumides/miniconda3/envs/gnn-qe/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['ninja', '-v']' returned non-zero exit status 1.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/mnt/ialabnas/homes/tacucumides/GNN-QE/script/run.py", line 59, in <module>
    train_and_validate(cfg, solver)
  File "/mnt/ialabnas/homes/tacucumides/GNN-QE/script/run.py", line 26, in train_and_validate
    solver.train(**kwargs)
  File "/home/tacucumides/miniconda3/envs/gnn-qe/lib/python3.10/site-packages/torchdrug/core/engine.py", line 161, in train
    loss, metric = model(batch)
  File "/home/tacucumides/miniconda3/envs/gnn-qe/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/mnt/ialabnas/homes/tacucumides/GNN-QE/gnnqe/task.py", line 56, in forward
    pred, target = self.predict_and_target(batch, all_loss, metric)
  File "/mnt/ialabnas/homes/tacucumides/GNN-QE/gnnqe/task.py", line 96, in predict_and_target
    pred = self.model(self.fact_graph, query, all_loss, metric)
  File "/home/tacucumides/miniconda3/envs/gnn-qe/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/mnt/ialabnas/homes/tacucumides/GNN-QE/gnnqe/model.py", line 101, in forward
    self.execute(graph, query, all_loss=all_loss, metric=metric)
  File "/mnt/ialabnas/homes/tacucumides/GNN-QE/gnnqe/model.py", line 94, in execute
    self.apply_projection(is_projection, graph, r_index, all_loss=all_loss, metric=metric)
  File "/mnt/ialabnas/homes/tacucumides/GNN-QE/gnnqe/model.py", line 168, in apply_projection
    t_prob = self.model(graph, h_prob, r_index, all_loss=all_loss, metric=metric)
  File "/home/tacucumides/miniconda3/envs/gnn-qe/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/mnt/ialabnas/homes/tacucumides/GNN-QE/gnnqe/model.py", line 220, in forward
    output = self.model(graph, input, all_loss=all_loss, metric=metric)
  File "/home/tacucumides/miniconda3/envs/gnn-qe/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/mnt/ialabnas/homes/tacucumides/GNN-QE/gnnqe/gnn.py", line 43, in forward
    hidden = layer(graph, layer_input)
  File "/home/tacucumides/miniconda3/envs/gnn-qe/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/tacucumides/miniconda3/envs/gnn-qe/lib/python3.10/site-packages/torchdrug/layers/conv.py", line 91, in forward
    update = self.message_and_aggregate(graph, input)
  File "/mnt/ialabnas/homes/tacucumides/GNN-QE/gnnqe/layer.py", line 140, in message_and_aggregate
    sum = functional.generalized_rspmm(adjacency, relation_input, input, sum="add", mul=mul)
  File "/home/tacucumides/miniconda3/envs/gnn-qe/lib/python3.10/site-packages/torchdrug/layers/functional/spmm.py", line 378, in generalized_rspmm
    return Function.apply(sparse.coalesce(), relation, input)
  File "/home/tacucumides/miniconda3/envs/gnn-qe/lib/python3.10/site-packages/torchdrug/layers/functional/spmm.py", line 172, in forward
    forward = spmm.rspmm_add_mul_forward_cuda
  File "/home/tacucumides/miniconda3/envs/gnn-qe/lib/python3.10/site-packages/torchdrug/utils/torch.py", line 26, in __getattr__
    return getattr(self.module, key)
  File "/home/tacucumides/miniconda3/envs/gnn-qe/lib/python3.10/site-packages/torchdrug/utils/decorator.py", line 102, in __get__
    result = self.func(obj)
  File "/home/tacucumides/miniconda3/envs/gnn-qe/lib/python3.10/site-packages/torchdrug/utils/torch.py", line 30, in module
    return cpp_extension.load(self.name, self.sources, self.extra_cflags, self.extra_cuda_cflags,
  File "/home/tacucumides/miniconda3/envs/gnn-qe/lib/python3.10/site-packages/torch/utils/cpp_extension.py", line 1284, in load
    return _jit_compile(
  File "/home/tacucumides/miniconda3/envs/gnn-qe/lib/python3.10/site-packages/torch/utils/cpp_extension.py", line 1508, in _jit_compile
    _write_ninja_file_and_build_library(
  File "/home/tacucumides/miniconda3/envs/gnn-qe/lib/python3.10/site-packages/torch/utils/cpp_extension.py", line 1623, in _write_ninja_file_and_build_library
    _run_ninja_build(
  File "/home/tacucumides/miniconda3/envs/gnn-qe/lib/python3.10/site-packages/torch/utils/cpp_extension.py", line 1916, in _run_ninja_build
    raise RuntimeError(message) from e
RuntimeError: Error building extension 'spmm': [1/5] /home/tacucumides/miniconda3/envs/gnn-qe/bin/nvcc  -DTORCH_EXTENSION_NAME=spmm -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -isystem /home/tacucumides/miniconda3/envs/gnn-qe/lib/python3.10/site-packages/torch/include -isystem /home/tacucumides/miniconda3/envs/gnn-qe/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -isystem /home/tacucumides/miniconda3/envs/gnn-qe/lib/python3.10/site-packages/torch/include/TH -isystem /home/tacucumides/miniconda3/envs/gnn-qe/lib/python3.10/site-packages/torch/include/THC -isystem /home/tacucumides/miniconda3/envs/gnn-qe/include -isystem /home/tacucumides/miniconda3/envs/gnn-qe/include/python3.10 -D_GLIBCXX_USE_CXX11_ABI=0 -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr -gencode=arch=compute_75,code=compute_75 -gencode=arch=compute_75,code=sm_75 --compiler-options '-fPIC' -O3 -std=c++14 -c /home/tacucumides/miniconda3/envs/gnn-qe/lib/python3.10/site-packages/torchdrug/layers/functional/extension/rspmm.cu -o rspmm.cuda.o 
FAILED: rspmm.cuda.o 
/home/tacucumides/miniconda3/envs/gnn-qe/bin/nvcc  -DTORCH_EXTENSION_NAME=spmm -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -isystem /home/tacucumides/miniconda3/envs/gnn-qe/lib/python3.10/site-packages/torch/include -isystem /home/tacucumides/miniconda3/envs/gnn-qe/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -isystem /home/tacucumides/miniconda3/envs/gnn-qe/lib/python3.10/site-packages/torch/include/TH -isystem /home/tacucumides/miniconda3/envs/gnn-qe/lib/python3.10/site-packages/torch/include/THC -isystem /home/tacucumides/miniconda3/envs/gnn-qe/include -isystem /home/tacucumides/miniconda3/envs/gnn-qe/include/python3.10 -D_GLIBCXX_USE_CXX11_ABI=0 -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr -gencode=arch=compute_75,code=compute_75 -gencode=arch=compute_75,code=sm_75 --compiler-options '-fPIC' -O3 -std=c++14 -c /home/tacucumides/miniconda3/envs/gnn-qe/lib/python3.10/site-packages/torchdrug/layers/functional/extension/rspmm.cu -o rspmm.cuda.o 
In file included from /home/tacucumides/miniconda3/envs/gnn-qe/lib/python3.10/site-packages/torchdrug/layers/functional/extension/rspmm.cu:1:0:
/home/tacucumides/miniconda3/envs/gnn-qe/lib/python3.10/site-packages/torch/include/ATen/cuda/CUDAContext.h:10:10: fatal error: cusolverDn.h: No such file or directory
 #include <cusolverDn.h>
          ^~~~~~~~~~~~~~
compilation terminated.
[2/5] /home/tacucumides/miniconda3/envs/gnn-qe/bin/nvcc  -DTORCH_EXTENSION_NAME=spmm -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -isystem /home/tacucumides/miniconda3/envs/gnn-qe/lib/python3.10/site-packages/torch/include -isystem /home/tacucumides/miniconda3/envs/gnn-qe/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -isystem /home/tacucumides/miniconda3/envs/gnn-qe/lib/python3.10/site-packages/torch/include/TH -isystem /home/tacucumides/miniconda3/envs/gnn-qe/lib/python3.10/site-packages/torch/include/THC -isystem /home/tacucumides/miniconda3/envs/gnn-qe/include -isystem /home/tacucumides/miniconda3/envs/gnn-qe/include/python3.10 -D_GLIBCXX_USE_CXX11_ABI=0 -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr -gencode=arch=compute_75,code=compute_75 -gencode=arch=compute_75,code=sm_75 --compiler-options '-fPIC' -O3 -std=c++14 -c /home/tacucumides/miniconda3/envs/gnn-qe/lib/python3.10/site-packages/torchdrug/layers/functional/extension/spmm.cu -o spmm.cuda.o 
FAILED: spmm.cuda.o 
/home/tacucumides/miniconda3/envs/gnn-qe/bin/nvcc  -DTORCH_EXTENSION_NAME=spmm -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -isystem /home/tacucumides/miniconda3/envs/gnn-qe/lib/python3.10/site-packages/torch/include -isystem /home/tacucumides/miniconda3/envs/gnn-qe/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -isystem /home/tacucumides/miniconda3/envs/gnn-qe/lib/python3.10/site-packages/torch/include/TH -isystem /home/tacucumides/miniconda3/envs/gnn-qe/lib/python3.10/site-packages/torch/include/THC -isystem /home/tacucumides/miniconda3/envs/gnn-qe/include -isystem /home/tacucumides/miniconda3/envs/gnn-qe/include/python3.10 -D_GLIBCXX_USE_CXX11_ABI=0 -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr -gencode=arch=compute_75,code=compute_75 -gencode=arch=compute_75,code=sm_75 --compiler-options '-fPIC' -O3 -std=c++14 -c /home/tacucumides/miniconda3/envs/gnn-qe/lib/python3.10/site-packages/torchdrug/layers/functional/extension/spmm.cu -o spmm.cuda.o 
In file included from /home/tacucumides/miniconda3/envs/gnn-qe/lib/python3.10/site-packages/torchdrug/layers/functional/extension/spmm.cu:1:0:
/home/tacucumides/miniconda3/envs/gnn-qe/lib/python3.10/site-packages/torch/include/ATen/cuda/CUDAContext.h:10:10: fatal error: cusolverDn.h: No such file or directory
 #include <cusolverDn.h>
          ^~~~~~~~~~~~~~
compilation terminated.
[3/5] c++ -MMD -MF spmm.o.d -DTORCH_EXTENSION_NAME=spmm -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -isystem /home/tacucumides/miniconda3/envs/gnn-qe/lib/python3.10/site-packages/torch/include -isystem /home/tacucumides/miniconda3/envs/gnn-qe/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -isystem /home/tacucumides/miniconda3/envs/gnn-qe/lib/python3.10/site-packages/torch/include/TH -isystem /home/tacucumides/miniconda3/envs/gnn-qe/lib/python3.10/site-packages/torch/include/THC -isystem /home/tacucumides/miniconda3/envs/gnn-qe/include -isystem /home/tacucumides/miniconda3/envs/gnn-qe/include/python3.10 -D_GLIBCXX_USE_CXX11_ABI=0 -fPIC -std=c++14 -Ofast -fopenmp -DAT_PARALLEL_OPENMP -DCUDA_OP -c /home/tacucumides/miniconda3/envs/gnn-qe/lib/python3.10/site-packages/torchdrug/layers/functional/extension/spmm.cpp -o spmm.o 
[4/5] c++ -MMD -MF rspmm.o.d -DTORCH_EXTENSION_NAME=spmm -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -isystem /home/tacucumides/miniconda3/envs/gnn-qe/lib/python3.10/site-packages/torch/include -isystem /home/tacucumides/miniconda3/envs/gnn-qe/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -isystem /home/tacucumides/miniconda3/envs/gnn-qe/lib/python3.10/site-packages/torch/include/TH -isystem /home/tacucumides/miniconda3/envs/gnn-qe/lib/python3.10/site-packages/torch/include/THC -isystem /home/tacucumides/miniconda3/envs/gnn-qe/include -isystem /home/tacucumides/miniconda3/envs/gnn-qe/include/python3.10 -D_GLIBCXX_USE_CXX11_ABI=0 -fPIC -std=c++14 -Ofast -fopenmp -DAT_PARALLEL_OPENMP -DCUDA_OP -c /home/tacucumides/miniconda3/envs/gnn-qe/lib/python3.10/site-packages/torchdrug/layers/functional/extension/rspmm.cpp -o rspmm.o 
ninja: build stopped: subcommand failed.

